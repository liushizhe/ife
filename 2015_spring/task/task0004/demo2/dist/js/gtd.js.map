{"version":3,"sources":["gtd.js"],"names":["define","util","$","addTask","click","taskAdd","nodeEditTittle","nodeEditDate","nodeEditDetail","value","style","display","closePop","innerHTML","confirmPop","strInput","nodeErr","strSel","length","getCatByKeyValue","cat1","cat2","cat","id","name","child","push","objFather","c","father","save","updateTaskList","INVALID_ID","addTaskList","html","list","i","getElementsByTagName","clickAllTaskList","ele","target","srcElement","tagName","toLowerCase","parentNode","nodes","hasClass","removeClass","addClass","updateTaskListDetail","finishTask","task","cat3","finish","alert","confirm","htmlEncode","str","replace","htmlDecode","editTask","modifyTask","nodeEditTitle","date","detail","match","arrDate","split","curC2","nodeCatAll","nodeCat1","c1","nodeCat2","console","log","c3","content","unclick","textContent","cancelAdd","taskClick","updateTaskDetail","obj","key","getIndexByKey","INVAILD_INDEX","sortDate","sort","a","b","getElementsByClassName","clickTaskStatus","parent","children","document","nodesFinish","j","indexOf","nodesLi","h6","updateStatusList","arrTaskID","searchID","del","uniqArray1","k","s","nodeID","oldChoose","curList","objChild","childEle","oldName","isClick","e","index","childIndex","taskIndex","splice","fatherObj","tag","nodesH4","nodesH5","localStorage","getItem","setItem","JSON","stringify","init","parse"],"mappings":"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","file":"gtd.js","sourcesContent":["\ndefine([\"util\", \"selector\"], function(util, $) {\n        //return an object to define the \"my/shirt\" module.\n        \n\nvar INVALID_ID = 0xffffffff;\nvar INVAILD_INDEX = 0xffffffff;\n/**\n * id当前及列表项标识\n * name列表项名称\n * child包含子列表标识（id）\n * father父列表项id\n * finish任务完成情况\n * date任务完成日期\n * content任务内容\n */\n/*\n<iframe src=javascript:alert('xss');height=0 width=0></iframe>\n */\n//第1级任务\n    var cat1 = [\n        {\n            \"id\": 0,\n            \"name\": \"默认分类\", \n            \"child\": [0]\n        },\n        {\n            \"id\": 1,\n            \"name\": \"默认分类2\",\n            \"child\": [1, 2]\n        }\n    ];\n    var cat2 = [\n        {\n            \"id\": 0,\n            \"name\": \"默认子分类\",\n            \"child\": [0, 1],\n            \"father\": 0\n        },\n        {\n            \"id\": 1,\n            \"name\": \"默认子分类21\",\n            \"child\": [],\n            \"father\": 1\n        },\n        {\n            \"id\": 2,\n            \"name\": \"默认子分类22\",\n            \"child\": [],\n            \"father\": 1\n        }\n    ]; \n    var cat3 = [\n        {\n            \"id\": 0,\n            \"name\": \"to-do 1\",\n            \"father\": 0,\n            \"finish\": true,\n            \"date\": \"2015-05-28\",\n            \"content\": \"开始 task0001 的编码任务。\"\n        },\n        {\n            \"id\": 1,\n            \"name\": \"to-do 3\",\n            \"father\": 0,\n            \"finish\": false,\n            \"date\": \"2015-05-30\",\n            \"content\": \"完成 task0001 的编码任务。\"\n        }\n    ];\n\n    function init() {\n        \n\n        if(!localStorage.getItem('cat1')) {\n            localStorage.setItem('cat1', JSON.stringify(cat1));\n            localStorage.setItem('cat2', JSON.stringify(cat2));\n            localStorage.setItem('cat3', JSON.stringify(cat3));\n        } else {\n            cat1 = JSON.parse(localStorage.getItem('cat1'));\n            cat2 = JSON.parse(localStorage.getItem('cat2'));\n            cat3 = JSON.parse(localStorage.getItem('cat3'));\n        }\n        var test = $('#t-list-all');\n\n        util.addClass($('#t-list-all'), 'choose');//默认选择所有任务列表\n        \n        util.click($('#t-list-all'), clickAllTaskList);\n        util.click($('.t-list-add'), addTaskList);\n        util.click($('.t-status-sel li')[0], clickTaskStatus);\n        util.click($('.t-status-sel li')[1], clickTaskStatus);\n        util.click($('.t-status-sel li')[2], clickTaskStatus);\n        util.click($('.icon-done'), finishTask);\n        util.click($('.icon-edit'), editTask);\n        util.click($('.btn3')[0], cancelAdd);\n        util.click($('.t-status-add'), addTask);\n\n        updateTaskList(INVALID_ID); //初始化\n    }\n//新建具体任务\nfunction addTask() {\n    util.click($('.btn3')[1], taskAdd);\n    var nodeEditTittle = $('.t-content-tittle .task-text');\n    var nodeEditDate = $('.t-content-date .task-text');\n    var nodeEditDetail = $('.t-content-detail .myTextArea');\n    // $('.t-status .t-status-add').click = null;//新增任务按钮不起作用\n    //日期 编辑文本框数据清除并隐藏正常显示内容\n    nodeEditTittle.value = '';\n    nodeEditDate.value = '';\n    nodeEditDetail.value = '';\n    $('.t-content-tittle span')[0].style.display = 'none';\n    $('.t-content-date span').style.display = 'none';\n    $('.t-content-detail span').style.display = 'none';\n    //日期 编辑文本框、保存、放弃按钮\n    nodeEditTittle.style.display = 'inline-block';\n    nodeEditDate.style.display = 'inline-block';\n    nodeEditDetail.style.display = 'inline-block';\n    $('.btn3')[0].style.display = 'inline-block';\n    $('.btn3')[1].style.display = 'inline-block';\n}\n//取消新增任务\nfunction closePop() {\n    $('.pop').style.display = 'none';\n    $('.overlay').style.display = 'none';\n    $('.pop-content').innerHTML = ''; \n}\n//确认新增任务\nfunction confirmPop() {\n    var strInput = $('.pop-content .new-task-name').value;\n    var nodeErr = $('.error');\n    var strSel = $('.cat-sel').value;\n\n    if(strInput.length === 0) {\n        nodeErr.innerHTML = '您输入内容为空';\n        return;\n    } else if(strInput.length > 10) {\n        nodeErr.innerHTML = '您输入内容超过10个字符';\n        return;\n    } else if(getCatByKeyValue(cat1, 'name', strInput)) {\n        nodeErr.innerHTML = '您输入分类已经存在';\n        return;\n    } else if(getCatByKeyValue(cat2, 'name', strInput)) {\n        nodeErr.innerHTML = '您输入子分类已经存在';\n        return;\n    }\n    if(strSel === '-1') {//新建分类\n        var cat = {\n            \"id\": cat1[cat1.length-1].id + 1,//id一直累加\n            \"name\": strInput,\n            \"child\": []\n        };\n        cat1.push(cat);\n    } else {\n        var objFather = getCatByKeyValue(cat1, 'id', cat1[strSel].id);\n        var c = {\n            \"id\": cat2[cat2.length-1].id + 1,//id一直累加\n            \"name\": strInput,\n            \"child\": [],\n            \"father\": objFather.id\n        };\n        objFather.child.push(c.id);\n        cat2.push(c);\n    }\n    save();\n    closePop();\n    // addClass($('#t-list-all'), 'choose');//默认选择所有任务列表\n    updateTaskList(INVALID_ID); //新增\n    \n}\n//添加新增任务列表按钮\nfunction addTaskList() {\n    $('.pop').style.display = 'block';\n    $('.overlay').style.display = 'block';\n    var html = '';\n    html += '<div>'\n        +    '任务名称:'\n        +    '<input type=\"text\" class=\"new-task-name new-task-name-p\" placeholder=\"输入新任务名称\">'\n        +    '</div>'\n        +    '<div>'\n        +    '任务目录:'\n        +    '<select class=\"cat-sel cat-sel-p\">'\n        +    '<option value=\"-1\">无</option>';\n    var list = $('#t-list-detail h4');\n    for(var i = 0; i < list.length; i++) {     \n        html += '<option value=\"' + i + '\">' + list[i].getElementsByTagName('span')[0].innerHTML + '</option>';\n    }\n    html += '</select>'\n            + '</div>'\n            +    '<div class=\"error\"></div>'\n            +    '<button class=\"pop-btn btn1\">取消</button>'\n            +    '<button class=\"pop-btn btn2\">确定</button>';\n    \n    $('.pop-content').innerHTML = html;            \n    util.click($('.btn1'), closePop);\n    util.click($('.btn2'), confirmPop);\n}\n//点击左侧任务列表按钮\nfunction clickAllTaskList(ele) {\n    //console.log(ele.target.tagName);\n    //window.event ? window.event.cancelBubble = true : e.stopPropagation();\n    ele = ele.target || ele.srcElement; \n    if(ele.tagName.toLowerCase() === 'span') {\n        ele = ele.parentNode;\n    }\n    var parent = $('.t-list');\n    var nodes = parent.getElementsByTagName('*');\n\n    for(var i = 0; i < nodes.length; i++) {\n        if(util.hasClass(nodes[i], 'choose')) {\n            util.removeClass(nodes[i], 'choose');\n        }\n    }\n    if(ele) {\n        util.addClass(ele, 'choose');\n    }\n    updateTaskListDetail(INVALID_ID);//新建删除都是靠点击文件栏\n}\n//点击任务完成按钮\nfunction finishTask() {\n    var task = getCatByKeyValue(cat3, 'name', $('.t-content-tittle span')[0].innerHTML);\n    if(task) {\n        if(task.finish) {\n            alert('任务已经完成！');\n            return;\n        } else {\n            var con = confirm(\"确定要设置任务为已完成状态吗？\");\n            if (!con) {\n                return;\n            }\n            task.finish = true;\n            // updateTaskList(task.id);\n            save();\n            updateTaskListDetail(task.id);//完成\n        }\n    }\n}\n//点击修改任务按钮\n\nfunction htmlEncode(str) {\n    return str.replace(/&/g, \"&amp;\")\n              .replace(/</g, \"&lt;\")\n              .replace(/>/g, \"&gt;\")\n              .replace(/\"/g, \"&quot;\")\n              .replace(/'/g, \"&#x27;\")\n              .replace(/\\//g, \"&#x2f;\")\n              .replace(/`/g, \"&#x60;\");\n}\n\nfunction htmlDecode(str) {\n    return str.replace(/&amp;/g, \"&\")\n              .replace(/&lt;/g, \"<\")\n              .replace(/&gt;/g, \">\")\n              .replace(/&quot;/g, \"\\\"\")\n              .replace(/&#x27;/g, \"\\'\")\n              .replace(/&#x2f;/g, \"\\/\")\n              .replace(/&#x60;/g, \"`\");\n}\n \nfunction editTask() {\n    if(!$('.t-content-tittle span')[0].innerHTML) {\n        return;\n    }\n    var nodeEditDate = $('.t-content-date .task-text');\n    var nodeEditDetail = $('.t-content-detail .myTextArea');\n    //$('.t-status .t-status-add').click = null;//新增任务按钮不起作用\n    util.click($('.btn3')[1], modifyTask);//保存按钮重新绑定监听事件，区分新增任务保存\n    //日期 编辑文本框数据清除并隐藏正常显示内容\n    $('.t-content-date .task-text').value = htmlDecode($('.t-content-tittle span')[0].innerHTML);\n    nodeEditDate.value = $('.t-content-date span').innerHTML;\n    nodeEditDetail.value = htmlDecode($('.t-content-detail span').innerHTML);\n    $('.t-content-date span').style.display = 'none';\n    $('.t-content-detail span').style.display = 'none';\n    //日期 编辑文本框、保存、放弃按钮\n    nodeEditDate.style.display = 'inline-block';\n    nodeEditDetail.style.display = 'inline-block';\n    $('.btn3')[0].style.display = 'inline-block';\n    $('.btn3')[1].style.display = 'inline-block';\n}\n//点击保存按钮，新增任务时保存\nfunction taskAdd() {\n    var nodeEditTitle = $('.t-content-tittle .task-text');\n    var nodeEditDate = $('.t-content-date .task-text');\n    var nodeEditDetail = $('.t-content-detail .myTextArea');\n    var name = htmlEncode(nodeEditTitle.value);\n    var date = nodeEditDate.value;\n    var detail = htmlEncode(nodeEditDetail.value);\n\n    if (name.length === 0) {\n        $('.taskError').innerHTML = '任务名字为空';\n        return;\n    }\n    if (getCatByKeyValue(cat3, 'name', name)) {\n        $('.taskError').innerHTML = '任务名字已经存在';\n        return;\n    }\n    if (!date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n        $('.taskError').innerHTML = '任务日期格式错误';\n        return;\n    }\n    var arrDate = date.split('-');\n    if (arrDate[1] < 1 || arrDate[1] > 12 || arrDate[2] < 1 || arrDate[2] > 31) {\n        $('.taskError').innerHTML = '任务日期有错，根本没有这一天';\n        return;\n    }\n    $('.t-content-tittle span')[0].innerHTML = name;\n    $('.t-content-date span').innerHTML = date;\n    $('.t-content-detail span').innerHTML = detail;\n    //保存数据\n    var curC2;//待添加的第二季任务列表对象\n    //确定第二级任务列表\n    var nodeCatAll = $('.t-list-wrap h3')[0];//h3元素包含所有任务和分类列表\n    if(util.hasClass(nodeCatAll, 'choose')) {//选中所有任务列表\n        curC2 = getCatByKeyValue(cat2, 'id', cat1[0].child[0]);//当前分类没有子分类，切换到默认分类的默认子分类\n    } else {//判断是否第1级任务列表\n        var nodeCat1 = $('.t-list-wrap h4');\n        var i;\n        for(i = 0; i < nodeCat1.length; i++) {\n            if(util.hasClass(nodeCat1[i], 'choose')) {\n                break;\n            }\n        }\n        if(i < nodeCat1.length) {//选中第一级列表\n            var c1 = getCatByKeyValue(cat1, 'name', nodeCat1[i].getElementsByTagName('span')[0].innerHTML);\n            if(c1.child.length === 0) {//当前分类没有子分类，切换到默认分类的默认子分类\n                curC2 = getCatByKeyValue(cat2, 'id', cat1[0].child[0]);\n            } else {//当前分类第一个子分类\n                curC2 = getCatByKeyValue(cat2, 'id', c1.child[0]);\n            }\n        } else {//选中第二级列表\n            var nodeCat2 = $('.t-list-wrap h5');\n            for(i = 0; i < nodeCat2.length; i++) {\n                if(util.hasClass(nodeCat2[i], 'choose')) {\n                    break;\n                }\n            }\n            if(i === nodeCat2.length) {//异常\n\n            } else {\n                curC2 = getCatByKeyValue(cat2, 'name', nodeCat2[i].getElementsByTagName('span')[0].innerHTML);\n            }\n        }\n    }\n    console.log(curC2);\n    /*\n    {\n        \"id\": 2,\n        \"name\": \"默认子分类22\",\n        \"child\": [],\n        \"father\": 1\n    }\n    {\n        \"id\": 0,\n        \"name\": \"to-do 1\",\n        \"father\": 0,\n        \"finish\": true,\n        \"date\": \"2015-05-28\",\n        \"content\": \"开始 task0001 的编码任务。\"\n    }\n     */\n    var c3 = {\n        \"id\": cat3[cat3.length-1].id + 1,\n        \"name\": name,\n        \"father\": curC2.id,\n        \"finish\": false,\n        \"date\": date,\n        \"content\": detail\n    };\n    cat3.push(c3);\n    curC2.child.push(c3.id);\n\n    //各个控件恢复显示\n    $('.t-content-tittle span')[0].style.display = 'inline-block';\n    $('.t-content-date span').style.display = 'inline-block';\n    $('.t-content-detail span').style.display = 'inline-block';\n    nodeEditTitle.style.display = 'none';\n    nodeEditDate.style.display = 'none';\n    nodeEditDetail.style.display = 'none';\n    $('.btn3')[0].style.display = 'none';\n    $('.btn3')[1].style.display = 'none';\n    $('.taskError').innerHTML = '';\n    save();\n    updateTaskList(c3.id); //任务栏新建\n    util.unclick($('.btn3')[1], taskAdd);\n}\n//点击保存按钮，编辑时保存\nfunction modifyTask() {\n    // $.click($('.t-status .t-status-add'), addTask);\n    var nodeEditDate = $('.t-content-date .task-text');\n    var nodeEditDetail = $('.t-content-detail .myTextArea');\n    var date = nodeEditDate.value;\n    var detail = htmlEncode(nodeEditDetail.value);\n\n    if (!date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n        $('.taskError').innerHTML = '任务日期格式错误';\n        return;\n    }\n    var arrDate = date.split('-');\n    if (arrDate[1] < 1 || arrDate[1] > 12 || arrDate[2] < 1 || arrDate[2] > 31) {\n        $('.taskError').innerHTML = '任务日期有错，根本没有这一天';\n        return;\n    }\n\n    $('.t-content-date span').innerHTML = date;\n    $('.t-content-detail span').innerHTML = detail;\n    var content = $('.t-content-tittle span')[0].textContent;\n    var cat = getCatByKeyValue(cat3, 'name', htmlEncode(content));//xss\n    cat.date = date;\n    cat.content = detail;\n\n    //各个控件恢复显示\n    $('.t-content-date span').style.display = 'inline-block';\n    $('.t-content-detail span').style.display = 'inline-block';\n    nodeEditDate.style.display = 'none';\n    nodeEditDetail.style.display = 'none';\n    $('.btn3')[0].style.display = 'none';\n    $('.btn3')[1].style.display = 'none';\n    $('.taskError').innerHTML = '';\n    // updateTaskList(cat.id);\n    save();\n    updateTaskListDetail(cat.id);  //保存\n    util.unclick($('.btn3')[1], modifyTask);\n}\n//点击放弃保存按钮\nfunction cancelAdd() {\n    // $.click($('.t-status .t-status-add'), addTask);\n    var nodeEditDate = $('.t-content-date .task-text');\n    var nodeEditDetail = $('.t-content-detail .myTextArea');\n\n    //各个控件恢复显示\n    $('.taskError').innerHTML = '';\n    $('.t-content-date span').style.display = 'inline-block';\n    $('.t-content-detail span').style.display = 'inline-block';\n    nodeEditDate.style.display = 'none';\n    nodeEditDetail.style.display = 'none';\n    $('.btn3')[0].style.display = 'none';\n    $('.btn3')[1].style.display = 'none';\n}\n//点击状态栏任务\nfunction taskClick(ele) {\n    ele = ele.target || ele.srcElement;\n    if(ele.tagName.toLowerCase() === 'span') {\n        ele = ele.parentNode;\n    }\n    var nodes = ele.parentNode.parentNode.parentNode.parentNode.getElementsByTagName('*');\n\n    for(var i = 0; i < nodes.length; i++) {\n        if(util.hasClass(nodes[i],'choose')) {\n            util.removeClass(nodes[i],'choose');\n        }\n    }\n     \n    util.addClass(ele, 'choose');\n    //更新任务详细信息\n    updateTaskDetail(ele);\n}\n\n//通过key-value获取列表项\nfunction getCatByKeyValue(obj, key, value) {\n    for(var i = 0; i < obj.length; i++) {\n        if(obj[i][key] === value) {\n            return obj[i];\n        }\n    }\n    return null;\n}\n//通过key-value获取列表项索引\nfunction getIndexByKey(obj, key, value) {\n    for(var i = 0; i < obj.length; i++) {\n        if(obj[i][key] === value) {\n            return i;\n        }\n    }\n    return INVAILD_INDEX;\n}\n//日期从小到大排序\nfunction sortDate(date) {\n    return date.sort(function (a, b) {\n        return a.replace(/-/g, '') - b.replace(/-/g, '');\n    });\n}\n//显示任务详细信息\nfunction updateTaskDetail(ele) {\n    if(ele) {\n        //var e = ele.getElementsByClassName('detail-text');//[0];\n\n        var html = ele.getElementsByClassName('detail-text')[0].textContent;\n\n        var name = htmlEncode(html);//xss\n        //console.log(ele.getElementsByClassName('detail-text')[0].innerHTML,html,name);\n        var obj = getCatByKeyValue(cat3, 'name', name);\n        $('.t-content-tittle span')[0].innerHTML = obj.name;\n        $('.t-content-date span').innerHTML = obj.date;\n        $('.t-content-detail span').innerHTML = obj.content;\n        $('.set-text').style.display = 'block';\n    } else {\n        $('.t-content-tittle span')[0].innerHTML = '';\n        $('.t-content-date span').innerHTML = '';\n        $('.t-content-detail span').innerHTML = '';\n        $('.set-text').style.display = 'none';\n    }\n}\n//选择状态列表完成情况 \nfunction clickTaskStatus(ele) {\n    if(ele === null) return;\n    ele = ele.target || ele.srcElement;\n    var parent = ele.parentNode;\n    for(var i = 0; i < parent.children.length; i++) {\n        if(util.hasClass(parent.children[i], 'choose')) {\n            util.removeClass(parent.children[i], 'choose');\n        }\n    }\n    util.addClass(ele, 'choose');\n    var str = ele.innerHTML;\n    nodes = document.getElementsByClassName('status-item');\n    for(var i = 0; i < nodes.length; i++) {\n        nodes[i].style.display = 'block';\n        nodesFinish = nodes[i].getElementsByClassName('task-finish');\n        if(nodesFinish) {\n            for(var j = 0; j < nodesFinish.length; j++) {\n                nodesFinish[j].parentNode.style.display = 'block';\n            }\n        }\n        nodesFinish = nodes[i].getElementsByClassName('task-unfinish');\n        if(nodesFinish) {\n            for(var j = 0; j < nodesFinish.length; j++) {\n                nodesFinish[j].parentNode.style.display = 'block';\n            }\n        }\n    }\n\n    if(str.indexOf('所有') !== -1) {\n        \n    } else if(str.indexOf('未完成') !== -1) {\n        for(var i = 0; i < nodes.length; i++) {\n            nodesFinish = nodes[i].getElementsByClassName('task-finish');\n            nodesLi = nodes[i].getElementsByTagName('li');\n            if(nodesFinish.length) {\n                if(nodesFinish.length === nodesLi.length) {\n                    nodes[i].style.display = 'none';\n                } else {\n                    for(var j = 0; j < nodesFinish.length; j++) {\n                        nodesFinish[j].parentNode.style.display = 'none';\n                    }\n                }\n                \n            }\n        }\n    } else if(str.indexOf('已完成') !== -1) {\n        for(var i = 0; i < nodes.length; i++) {\n            nodesFinish = nodes[i].getElementsByClassName('task-unfinish');\n            nodesLi = nodes[i].getElementsByTagName('li');\n            if(nodesFinish.length) {\n                if(nodesFinish.length === nodesLi.length) {\n                    nodes[i].style.display = 'none';\n                } else {\n                    for(var j = 0; j < nodesFinish.length; j++) {\n                        nodesFinish[j].parentNode.style.display = 'none';\n                    }\n                }\n                \n            }\n        }\n    }\n\n    var h6 = document.getElementsByTagName('h6');        // 默认选择第一个任务\n    //console.log(h6[0].parentNode.parentNode.parentNode.style.display, h6[1].parentNode.parentNode.parentNode.style.display);\n    for (var i = 0; i < h6.length; i++) {\n        if (h6[i].parentNode.parentNode.parentNode.style.display !== 'none') {\n            h6[i].click();\n            break;\n        }\n    }\n}\n//更新状态列表\n//返回选中任务\nfunction updateStatusList(arrTaskID, searchID) {\n    var date = [];\n    var task = [];\n    var html = '';\n\n    var nodes = document.getElementsByTagName('h6');\n    if(nodes) {\n        for(var i = 0; i < nodes.length; i++) {\n            util.unclick(nodes[i], taskClick);\n        }\n    }\n    var nodes = document.getElementsByClassName('t-status-choose')[0].getElementsByClassName('delete');\n    if(nodes) {\n        for(var i = 0; i < nodes.length; i++) {\n            util.unclick(nodes[i], del);\n        }\n    }\n\n    for(var i = 0; i < arrTaskID.length; i++) {\n        var obj = getCatByKeyValue(cat3, 'id', arrTaskID[i]);\n        task.push(obj);\n        date.push(obj.date);\n    }\n    date = util.uniqArray1(date);\n    date = sortDate(date);\n    var k = 0;\n    var s = false;\n    for(var i = 0; i < date.length; i++) {\n        html += '<li class=\"status-item\"><h5>'+date[i]+'</h5><ul>';\n        for(var j = 0; j < task.length; j++) {\n            if(task[j].date === date[i]) {\n                if(task[j].finish === true) {\n                    html += '<li><h6 class=\"task-finish\">';\n                } else {\n                    html += '<li><h6 class=\"task-unfinish\">';\n                }\n                html += '<i class=\"icon-check\"></i>' \n                + '<span class=\"detail-text\">'\n                +task[j].name+'</span>'\n                +'<i class=\"delete icon-minus-circled\"></i>'\n                +'</h6></li>';\n                 if(s === false) {\n                     if(searchID === task[j].id) {\n                        s = true;\n                     } else {\n                        k++;\n                     }\n                 }\n            }\n        }\n        html += '</ul></li>';\n    }\n    $('.t-status-choose').innerHTML = html;\n    var nodes = document.getElementsByTagName('h6');\n    for(var i = 0; i < nodes.length; i++) {\n        util.click(nodes[i], taskClick);\n    }\n    var nodes = document.getElementsByClassName('t-status-choose')[0].getElementsByClassName('delete');\n    for(var i = 0; i < nodes.length; i++) {\n        util.click(nodes[i], del);\n    }\n    if(s === false) {\n        return 0;\n    } else {\n        return k;\n    }\n    // var ele = $('.t-status-choose');\n    // ele = ele.getElementsByTagName('ul')[0];\n    // ele = ele.getElementsByTagName('li')[0];\n    // addClass($('h6')[0], 'choose');\n}\n//更新任务状态及详细信息\nfunction  updateTaskListDetail(nodeID) {\n    var oldChoose = $('.t-status-choose .choose');     // 保存正在选中的任务\n    // var nodesStatus = document.getElementsByClassName('t-status-sel')[0].getElementsByTagName('li');\n    $('.t-status-sel li')[0].click();;\n    // for(var i = 0; i < nodesStatus.length; i++) {\n    //     nodesStatus[i].click();\n    // }\n    var curList = $('.t-list-wrap .choose');//确定当前选择任务列表\n    var hightlight = 0;\n    var arrTaskID = [];//存续需要显示任务ID\n    if(curList) {\n        var tag = curList.tagName.toLowerCase();\n        //获取具体任务项\n        switch (tag) {\n            case 'h3':\n                for(var i = 0; i < cat3.length; i++) {\n                    arrTaskID.push(cat3[i].id);\n                }\n                hightlight = updateStatusList(arrTaskID, nodeID);\n                break;\n            case 'h4':\n                var name = curList.getElementsByTagName('span')[0].innerHTML;\n                var obj = getCatByKeyValue(cat1, 'name', name);\n                if(obj) {\n                    for(var i = 0; i < obj.child.length; i++) {\n                        var objChild = getCatByKeyValue(cat2, 'id', obj.child[i]);\n                        for(var j = 0; j < objChild.child.length; j++) {\n                            arrTaskID.push(objChild.child[j]);\n                        }\n                    }\n                }\n                hightlight = updateStatusList(arrTaskID, nodeID);\n                break;\n            case 'h5':\n                var name = curList.getElementsByTagName('span')[0].innerHTML;\n                var obj = getCatByKeyValue(cat2, 'name', name);\n                if(obj) {\n                    for(var i = 0; i < obj.child.length; i++) {\n                        arrTaskID.push(obj.child[i]);       \n                    }\n                }\n                hightlight = updateStatusList(arrTaskID, nodeID);\n\n                break;\n            default:\n                // statements_def\n                break;\n        }\n    }\n    //更新任务详细信息\n    if(arrTaskID.length) {\n        //document.getElementsByTagName('h6')[hightlight].click();\n        if (oldChoose) {// 恢复之前选中的选项\n            var childEle = document.getElementsByTagName('h6');\n            var oldName = oldChoose.getElementsByTagName('span')[0].innerHTML;\n            var isClick = false;\n            for (var i = 0; i < childEle.length; i++) {\n                if (childEle[i].getElementsByTagName('span')[0].innerHTML === oldName) {\n                    childEle[i].click();\n                    isClick = true;\n                    break;\n                }\n                if (!isClick && $('h6')) {                                   // 之前选中的元素不再显示的情况\n                    document.getElementsByTagName('h6')[0].click();\n                }\n            }\n        }\n        else if ($('h6')) {                   // 否则默认选择第一个任务\n            var s = document.getElementsByTagName('h6');\n            s[0].click();\n        }\n    }\n    else {\n        updateTaskDetail(null);//清除任务详细信息\n    }\n}\n//删除任务\nfunction del(e) {\n    //阻止事件冒泡，因为删除事件重绘DOM，有可能造成页面崩溃\n    //window.event ? window.event.cancelBubble = true : e.stopPropagation(); \n    var con = confirm(\"删除操作不可逆，确定要删除吗？\");\n    if (!con) {\n        return;\n    }\n    e = e.target || e.srcElement;\n    var parent = e.target.parentNode;\n    var name = parent.getElementsByTagName('span')[0].innerHTML;\n    var tag = parent.tagName.toLowerCase();\n\n    switch (tag) {\n        case 'h4':                                                          // 删除一个分类\n            index = getIndexByKey(cat1, 'name', name);\n\n            for (var i = 0; i < cat1[index].child.length; i++) {            // 删除该分类下的所有子分类及任务\n                var childIndex = getIndexByKey(cat2, 'id', cat1[index].child[i]);\n                for (var j = 0; j < cat2[childIndex].child.length; j ++) {\n                    var taskIndex = getIndexByKey(cat3, 'id', cat2[childIndex].child[j])\n                    cat3.splice(taskIndex, 1);\n                }\n                cat2.splice(childIndex, 1);\n            }\n            cat1.splice(index, 1);\n            break;\n        case 'h5':                                                          // 删除一个子分类\n            index = getIndexByKey(cat2, 'name', name);\n\n            for (var i = 0; i < cat2[index].child.length; i++) {       // 删除该子分类下的所有任务\n                var taskIndex = getIndexByKey(cat3, 'id', cat2[index].child[i])\n                cat3.splice(taskIndex, 1);\n            }\n\n            var fatherObj = getCatByKeyValue(cat1, 'id', cat2[index].father);  // 删除父节点中的记录\n            fatherObj.child.splice(fatherObj.child.indexOf(cat2[index].id), 1);\n            cat2.splice(index, 1);\n            break;\n        case 'h6':\n            index = getIndexByKey(cat3, 'name', name);\n\n            var fatherObj = getCatByKeyValue(cat2, 'id', cat3[index].father);  // 删除父节点中的记录\n            fatherObj.child.splice(fatherObj.child.indexOf(cat3[index].id), 1);\n            cat3.splice(index, 1);\n            break;\n    }\n    save();\n    updateTaskList(INVALID_ID);  //删除  任务栏->文件拦，文件拦->文件栏\n}\n//更新网页左中内容\nfunction updateTaskList(nodeID) {\n    var preTask = $('.t-status-choose .choose');//状态列表选中情况\n    var curList = $('.t-list-wrap .choose');//确定当前选择任务列表\n    // if(curList === null) {\n    //     addClass($('#t-list-all'), 'choose');\n    // }\n    //更新左侧文件列表\n    $('#t-list-all').innerHTML = '<span>所有任务</span>('+cat3.length+')';\n    // var name = curList.getElementsByTagName('span')[0].innerHTML;\n    var html = '';\n\n    for (var i = 0; i < cat1.length; i++) {\n        var length = 0;\n        var obj = cat1[i];\n        for(var k = 0; k < obj.child.length; k++) {\n            length += cat2[getIndexByKey(cat2, 'id', obj.child[k])].child.length;\n        }\n        // if(name != cat1[i].name) {\n            html += '<li><h4>'; \n        // } else {\n        //     html += '<li><h4 onclick=\"clickAllTaskList(this)\" class=\"choose\">'; \n        // }\n        html += '<span>' + cat1[i].name + '</span>'\n        + '(' + length + ')'; \n        // if(i !== 0)\n        {\n            html += '<i class=\"delete icon-minus-circled\"></i>';\n        }\n        html += '</h4><ul class=\"t-list-item\">';\n        for (var j = 0; j < cat2.length; j++) {\n            if(cat1[i].id === cat2[j].father) {\n                // if(name != cat2[j].name) {\n                    html += '<li><h5>';\n                // } else {\n                //     html += '<li><h5 onclick=\"clickAllTaskList(this)\" class=\"choose\">'; \n                // }\n                html += '<span>' + cat2[j].name + '</span>'\n                + '('+ cat2[j].child.length + ')';\n                // if(!(i === 0 && j === 0))\n                {\n                    html += '<i class=\"delete icon-minus-circled\"></i>';\n                }\n                html += '</h5></li>';\n            }\n        }\n        html += '</ul></li>';\n    }\n    html = html.replace(/<i class=\"delete icon-minus-circled\"><\\/i>/, '');    // 去掉默认分类的删除按钮\n    html = html.replace(/<i class=\"delete icon-minus-circled\"><\\/i>/, '');    // 去掉默认子分类的删除按钮\n    $('#t-list-detail').innerHTML = html;\n    // util.click($('#t-list-all'), clickAllTaskList);\n    var nodes = $('#t-list-detail').getElementsByTagName('h4');\n    for(var i = 0; i < nodes.length; i++) {\n        util.click(nodes[i], clickAllTaskList)\n    }\n    var nodes = $('#t-list-detail').getElementsByTagName('h5');\n    for(var i = 0; i < nodes.length; i++) {\n        util.click(nodes[i], clickAllTaskList)\n    }\n    var nodes = $('#t-list-detail').getElementsByClassName('delete');\n    for(var i = 0; i < nodes.length; i++) {\n        util.click(nodes[i], del)\n    }\n    //左边列表项重置后需重新点击\n    if(curList) {\n        var tag = curList.tagName.toLowerCase();\n        var name = curList.getElementsByTagName('span')[0].innerHTML;\n        var click = false;//检测查找节点是否存在，因为有可能被删掉\n        switch (tag) {\n            case 'h3':\n                document.getElementsByTagName('h3')[0].click();\n                click = true;\n                break;\n            case 'h4':\n                var nodesH4 = $('#t-list-detail').getElementsByTagName('h4');\n                for(var i = 0; i < nodesH4; i++) {\n                    if(name === nodesH4[i].getElementsByTagName('span')[0].innerHTML) {\n                        nodesH4[i].click();\n                        click = true;\n                        break;\n                    }\n                }\n                break;\n            case 'h5':\n                var nodesH5 = $('#t-list-detail').getElementsByTagName('h5');\n                for(var i = 0; i < nodesH5; i++) {\n                    if(name === nodesH5[i].getElementsByTagName('span')[0].innerHTML) {\n                        nodesH5[i].click();\n                        click = true;\n                        break;\n                    }\n                }\n                break;\n            default:\n                // statements_def\n                break;\n        }\n        if(!click) {\n            $('h3')[0].click();\n        }\n    } else {\n        $('h3')[0].click();\n    }\n    //更新中间各文件状态，默认选择所有、首条todo列表，todo列表按日期排序\n    //updateTaskListDetail(nodeID);\n}\nfunction save() {\n    if(localStorage.getItem('cat1')) {\n        localStorage.setItem('cat1', JSON.stringify(cat1));\n        localStorage.setItem('cat2', JSON.stringify(cat2));\n        localStorage.setItem('cat3', JSON.stringify(cat3));\n    }\n}\n\n    return {\n        init: init\n    }\n});\n"]}