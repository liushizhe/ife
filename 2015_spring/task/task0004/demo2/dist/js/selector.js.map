{"version":3,"sources":["selector.js"],"names":["define","util","selector","blank","direct","part","actions","id","className","tag","attribute","fn","params","slice","call","arguments","result","match","idReg","push","classReg","tagReg","attrReg","key","value","apply","filterParents","parts","ret","parentPart","pop","i","len","length","node","p","parentNode","el","hasClass","tagName","toLowerCase","valid","hasAttribute","getAttribute","matches","context","document","getElementById","getElementsByClassName","temp","getElementsByTagName","split"],"mappings":"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","file":"selector.js","sourcesContent":["define([\"util\"], function(util) {\n\t\n\n\tfunction $(selector) {\n\t    var idReg = /^#([\\w_\\-]+)/;\n\t    var classReg = /^\\.([\\w_\\-]+)/;\n\t    var tagReg = /^\\w+$/i;\n\t    // [data-log]\n\t    // [data-log=\"test\"]\n\t    // [data-log=test]\n\t    // [data-log='test']\n\t    var attrReg = /(\\w+)?\\[([^=\\]]+)(?:=([\"'])?([^\\]\"']+)\\3?)?\\]/;\n\n\t    // 不考虑'>' 、`~`等嵌套关系\n\t    // 父子选择器之间用空格相隔\n\t    var context = document;\n\n\t    function blank() {}\n\n\t    function direct(part, actions) {\n\t        actions = actions || {\n\t            id: blank,\n\t            className: blank,\n\t            tag: blank,\n\t            attribute: blank\n\t        };\n\t        var fn;\n\t        var params = [].slice.call(arguments, 2);\n\t        // id\n\t        if (result = part.match(idReg)) {\n\t            fn = 'id';\n\t            params.push(result[1]);\n\t        }\n\t        // class\n\t        else if (result = part.match(classReg)) {\n\t            fn = 'className';\n\t            params.push(result[1]);\n\t        }\n\t        // tag\n\t        else if (result = part.match(tagReg)) {\n\t            fn = 'tag';\n\t            params.push(result[0]);\n\t        }\n\t        // attribute\n\t        else if (result = part.match(attrReg)) {\n\t            fn = 'attribute';\n\t            var tag = result[1];\n\t            var key = result[2];\n\t            var value = result[4];\n\t            params.push(tag, key, value);\n\t        }\n\t        return actions[fn].apply(null, params);\n\t    }\n\n\t    function find(parts, context) {\n\t        var part = parts.pop();\n\n\t        var actions = {\n\t            id: function (id) {\n\t                return [\n\t                    document.getElementById(id)\n\t                ];\n\t            },\n\t            className: function (className) {\n\t                var result = [];\n\t                if (context.getElementsByClassName) {\n\t                    result = context.getElementsByClassName(className)\n\t                }\n\t                else {\n\t                    var temp = context.getElementsByTagName('*');\n\t                    for (var i = 0, len = temp.length; i < len; i++) {\n\t                        var node = temp[i];\n\t                        if (util.hasClass(node, className)) {\n\t                            result.push(node);\n\t                        }\n\t                    }\n\t                }\n\t                return result;\n\t            },\n\t            tag: function (tag) {\n\t                return context.getElementsByTagName(tag);\n\t            },\n\t            attribute: function (tag, key, value) {\n\t                var result = [];\n\t                var temp = context.getElementsByTagName(tag || '*');\n\n\t                for (var i = 0, len = temp.length; i < len; i++) {\n\t                    var node = temp[i];\n\t                    if (value) {\n\t                        var v = node.getAttribute(key);\n\t                        (v === value) && result.push(node);\n\t                    }\n\t                    else if (node.hasAttribute(key)) {\n\t                        result.push(node);\n\t                    }\n\t                }\n\t                return result;\n\t            }\n\t        };\n\n\t        var ret = direct(part, actions);\n\n\t        // to array\n\t        ret = [].slice.call(ret);\n\n\t        return parts[0] && ret[0] ? filterParents(parts, ret) : ret;\n\t    }\n\n\t    function filterParents(parts, ret) {\n\t        var parentPart = parts.pop();\n\t        var result = [];\n\n\t        for (var i = 0, len = ret.length; i < len; i++) {\n\t            var node = ret[i];\n\t            var p = node;\n\n\t            while (p = p.parentNode) {\n\t                var actions = {\n\t                    id: function (el, id) {\n\t                        return (el.id === id);\n\t                    },\n\t                    className: function (el, className) {\n\t                         return util.hasClass(el, className);\n\t                    },\n\t                    tag: function (el, tag) {\n\t                        return (el.tagName.toLowerCase() === tag);\n\t                    },\n\t                    attribute: function (el, tag, key, value) {\n\t                        var valid = true;\n\t                        if (tag) {\n\t                            valid = actions.tag(el, tag);\n\t                        }\n\t                        valid = valid && el.hasAttribute(key);\n\t                        if (value) {\n\t                            valid = valid && (value === el.getAttribute(key))\n\t                        }\n\t                        return valid;\n\t                    }\n\t                };\n\t                var matches = direct(parentPart, actions, p);\n\n\t                if (matches) {\n\t                    break;\n\t                }\n\t            }\n\n\t            if (matches) {\n\t                result.push(node);\n\t            }\n\t        }\n\n\t        return parts[0] && result[0] ? filterParents(parts, result) : result;\n\t    }\n\n\t    var result = find(selector.split(/\\s+/), context);\n\n\t    return result.length === 0 ? null: (result.length === 1 ? result.pop() : result);\n\t}\n\n\treturn $;\n\n});\n"]}